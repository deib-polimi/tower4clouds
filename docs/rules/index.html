<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Tower 4Clouds</title>

    <link rel="stylesheet" href="http://deib-polimi.github.io/tower4clouds/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://deib-polimi.github.io/tower4clouds/css/highlight.dark.css">
    <link rel="stylesheet" href="http://deib-polimi.github.io/tower4clouds/css/main.css">
</head>
<body class="">

<header class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <a href="http://deib-polimi.github.io/tower4clouds/" class="navbar-brand"><img src="http://deib-polimi.github.io/tower4clouds/img/logo-small.png" alt=""></a>
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div class="navbar-collapse collapse" id="navbar-main">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://deib-polimi.github.io/tower4clouds/">Home</a></li>
                <li><a href="http://deib-polimi.github.io/tower4clouds/docs/get-started.html">Get started</a></li>
                <li><a href="http://deib-polimi.github.io/tower4clouds/docs/">Documentation</a></li>
                                <li>
                    <a href="https://github.com/deib-polimi/tower4clouds">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                </li>
                            </ul>
        </div>
    </div>
</header>


<main class="container-fluid">
    <div class="row">

        

        <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

            <ul class="nav nav-pills nav-stacked">
                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/">
                        Documentation Index
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/overview.html">
                        Overview
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/get-started.html">
                        Get started
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/tutorial.html">
                        Tutorial
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/mosaic-installation.html">
                        Installation on mOSAIC
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/data-collectors/">
                        Data Collectors
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/manager/">
                        Manager
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/data-analyzer/">
                        Data Analyzer
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/model/">
                        The Model
                    </a>
                </li>
                                                <li class="active">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/rules/">
                        Rules
                    </a>
                </li>
                                <ul class="submenu nav nav-stacked nav-pills">
                                        <li class="">
                        <a href="http://deib-polimi.github.io/tower4clouds/docs/rules/actions/">
                            Actions
                        </a>
                    </li>

                    
                                    </ul>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/docs/observers/">
                        Observers
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/CHANGELOG.html">
                        Change log
                    </a>
                </li>
                                                <li class="">
                    <a href="http://deib-polimi.github.io/tower4clouds/CONTRIBUTING.html">
                        Contributing
                    </a>
                </li>
                                            </ul>

        </nav>

        
        <section id="content" class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
            <h1 id="rules">Rules</h1>
<p>Tower 4Clouds rules are &quot;recipes&quot; that describe what and how the monitoring platform should monitor and how monitoring data should be aggregated. The user can also specify actions to be performed and conditions under which actions should be performed.</p>
<p>The metamodel of a monitoring rule is formally specified as an XML schema, available <a href="https://raw.githubusercontent.com/deib-polimi/tower4clouds/master/rules/metamodels/monitoring_rules_schema.xsd">here</a>.</p>
<p>Here is a graphical representation of the schema:</p>
<p><img src="monitoring_rules_schema.png" alt="monitoring rule schema" title="monitoring_rules_schema" /></p>
<p>Here is a list of the attributes with a short description:</p>
<ul>
<li><em>metricName</em>: the name of the target metric</li>
<li><em>monitoredTargets</em>: the list of targets resources targeted by the rule</li>
<li><em>metricAggregation</em>: specifies how data should be transformed (optional)</li>
<li><em>timeStep</em>: time interval in seconds between two consecutive evaluations of the rule</li>
<li><em>timeWindow</em>: time range in seconds in which data should be considered to be aggregated at every time step</li>
<li><em>startEnabled</em>: specifies whether the rule evaluation should start once installed</li>
<li><em>relatedQosConstraintId</em>: if specified, identifies the id of the qos constraint from which the rule is generated</li>
<li><em>condition</em>: the condition to be evaluated on the aggregated metric or, in case no aggregation is specified, on raw data</li>
<li><em>actions</em>: the list of actions to be executed for each monitoring datum (produced by aggregation or raw datum).
If a condition is specified the action is performed if and only if the condition is verified. The list of available actions can be found <a href="actions">here</a>.</li>
</ul>
<h2 id="condition-syntax">Condition Syntax</h2>
<pre><code>&lt;condition&gt; ::= &lt;term&gt; | &lt;term&gt; ` || ' &lt;condition&gt;

&lt;term&gt; ::= &lt;factor&gt; | &lt;factor&gt; ` &amp;&amp; ' &lt;term&gt;

&lt;factor&gt; ::= &lt;atom&gt; | `!' &lt;factor&gt; | `(' &lt;condition&gt; `)'

&lt;atom&gt; ::= &lt;var&gt; &lt;operator&gt; &lt;var&gt;

&lt;var&gt; ::= `METRIC' | &lt;decimal&gt;

&lt;operator&gt; ::= `&gt;=' | `&lt;=' | `=' | `&lt;&gt;' | `&gt;' | `&lt;'</code></pre>
<h2 id="examples">Examples</h2>
<p>Here are some examples of monitoring rules:</p>
<pre><code class="language-xml">&lt;monitoringRules
    xmlns="http://www.modaclouds.eu/xsd/1.0/monitoring_rules_schema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.modaclouds.eu/xsd/1.0/monitoring_rules_schema"&gt;
    &lt;monitoringRule timeWindow="30" timeStep="30" id="cpuRule"&gt;
        &lt;monitoredTargets&gt;
            &lt;monitoredTarget class="VM" type="Frontend" /&gt;
        &lt;/monitoredTargets&gt;
        &lt;collectedMetric metricName="CpuUtilization"&gt;
            &lt;parameter name="samplingProbability"&gt;1&lt;/parameter&gt;
            &lt;parameter name="samplingTime"&gt;10&lt;/parameter&gt;
        &lt;/collectedMetric&gt;
        &lt;metricAggregation aggregateFunction="Average"
            groupingClass="CloudProvider" /&gt;
        &lt;actions&gt;
            &lt;action name="OutputMetric"&gt;
                &lt;parameter name="metric"&gt;FrontendCPUUtilization&lt;/parameter&gt;
            &lt;/action&gt;
        &lt;/actions&gt;
    &lt;/monitoringRule&gt;
    &lt;monitoringRule timeWindow="30" timeStep="30" id="respTimeRule"&gt;
        &lt;monitoredTargets&gt;
            &lt;monitoredTarget class="Method" type="answerQuestions" /&gt;
            &lt;monitoredTarget class="Method" type="saveAnswers" /&gt;
            &lt;monitoredTarget class="Method" type="register" /&gt;
        &lt;/monitoredTargets&gt;
        &lt;collectedMetric metricName="ResponseTime"&gt;
            &lt;parameter name="samplingProbability"&gt;1&lt;/parameter&gt;
        &lt;/collectedMetric&gt;
        &lt;metricAggregation aggregateFunction="Average"/&gt;
        &lt;actions&gt;
            &lt;action name="OutputMetric"&gt;
                &lt;parameter name="metric"&gt;AverageRespTime&lt;/parameter&gt;
                &lt;parameter name="resourceId"&gt;AllMyFrontendMethods&lt;/parameter&gt;
            &lt;/action&gt;
        &lt;/actions&gt;
    &lt;/monitoringRule&gt;
    &lt;monitoringRule id="RestCallRule"
        startEnabled="true" timeStep="5" timeWindow="5"&gt;
        &lt;monitoredTargets&gt;
            &lt;monitoredTarget class="Method" type="register"/&gt;
        &lt;/monitoredTargets&gt;
        &lt;collectedMetric metricName="ResponseTime"&gt;
            &lt;parameter name="samplingProbability"&gt;1&lt;/parameter&gt;
        &lt;/collectedMetric&gt;
        &lt;metricAggregation aggregateFunction="Average" groupingClass="Method"/&gt;
        &lt;actions&gt;
            &lt;action name="RestCall"&gt;
                &lt;parameter name="url"&gt;http://localhost:8170/v1/monitoring-rules/RestCallRule&lt;/parameter&gt;
                &lt;parameter name="method"&gt;DELETE&lt;/parameter&gt;
            &lt;/action&gt;
        &lt;/actions&gt;
    &lt;/monitoringRule&gt;
&lt;/monitoringRules&gt;</code></pre>
<p>Rules can also be concatenated, here is an example of a Rule using the metric generated by the first rule as input to generate a new metric. The first rule aggregates the response time of all methods on each Internal Component, the second rule filters only those monitoring data regarding a specific type of Internal Component (Mic).</p>
<pre><code class="language-xml">&lt;monitoringRules xmlns="http://www.modaclouds.eu/xsd/1.0/monitoring_rules_schema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.modaclouds.eu/xsd/1.0/monitoring_rules_schema"&gt;
  &lt;monitoringRule id="respTimeIntCompRule" timeStep="60" timeWindow="60"&gt;
    &lt;monitoredTargets&gt;
      &lt;monitoredTarget class="Method"/&gt;
    &lt;/monitoredTargets&gt;
    &lt;collectedMetric metricName="ResponseTime"&gt;
      &lt;parameter name="samplingProbability"&gt;1&lt;/parameter&gt;
    &lt;/collectedMetric&gt;
    &lt;metricAggregation aggregateFunction="Average" groupingClass="InternalComponent"/&gt;
    &lt;actions&gt;
      &lt;action name="OutputMetric"&gt;
        &lt;parameter name="metric"&gt;AverageInternalComponentResponseTime&lt;/parameter&gt;
        &lt;parameter name="value"&gt;METRIC&lt;/parameter&gt;
        &lt;parameter name="resourceId"&gt;ID&lt;/parameter&gt;
      &lt;/action&gt;
    &lt;/actions&gt;
  &lt;/monitoringRule&gt;

  &lt;monitoringRule id="respTimeMicRule" timeStep="60" timeWindow="60"&gt;
    &lt;monitoredTargets&gt;
      &lt;monitoredTarget class="InternalComponent" type="Mic"/&gt;
    &lt;/monitoredTargets&gt;
    &lt;collectedMetric metricName="AverageInternalComponentResponseTime"/&gt;
    &lt;actions&gt;
      &lt;action name="OutputMetric"&gt;
        &lt;parameter name="metric"&gt;AverageMicResponseTime&lt;/parameter&gt;
        &lt;parameter name="value"&gt;METRIC&lt;/parameter&gt;
        &lt;parameter name="resourceId"&gt;ID&lt;/parameter&gt;
      &lt;/action&gt;
    &lt;/actions&gt;
  &lt;/monitoringRule&gt;
&lt;/monitoringRules&gt;</code></pre>
        </section>

    </div>
</main>



<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="http://yastatic.net/highlightjs/8.2/highlight.min.js"></script>

<script>
    $(function() {
        $("section>h1").wrap('<div class="page-header" />');
        // Syntax highlighting
        hljs.initHighlightingOnLoad();
    });
</script>


</body>
</html>
